<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}"></head>
<body class="page-home" th:classappend="${showProductsTable == true} ? 'products-loaded' : ''">
<div th:replace="~{fragments/header :: header}"></div>

<div class="page-wrapper">
    <header class="page-header">
        <h1>Products</h1>
        <p class="page-subtitle">Manage your product catalog</p>
    </header>

    <div class="page-card">
        <div class="toolbar" th:if="${showProductsTable != true}">
            <wa-button
                    id="loadBtn"
                    type="button"
                    size="large"
                    pill
                    variant="brand"
                    hx-get="/products/load"
                    hx-target="#productsContainer"
                    hx-swap="innerHTML">
                <wa-icon name="spinner" animation="spin"></wa-icon>
                <span th:text="#{index.loadProducts}"></span>
            </wa-button>
        </div>
        <div id="productsContainer">
            <th:block th:if="${showProductsTable == true}" th:insert="~{fragments/products :: productsTableWithButton}"></th:block>
        </div>
    </div>
</div>

<script>
    document.body.addEventListener('htmx:afterSwap', function (evt) {
        if (evt.target.id === 'productsContainer') {
            document.body.classList.add('products-loaded');
            var loadBtn = document.getElementById('loadBtn');
            if (loadBtn) loadBtn.remove();
        }
    });
</script>
</body>
</html>